<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Peak Hub - Ultimate Edition</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><path d='M50 10 L70 50 L90 90 L10 90 L30 50 Z' fill='%2300d4ff'/></svg>">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Inter:wght@400;600;700&family=Fira+Code&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#0a0e27;--bg2:#151b3d;--bg3:#1e2749;--acc:#00d4ff;--txt:#e8eaf0;--txt2:#8b93b8;--border:rgba(255,255,255,.08);--border-acc:rgba(0,212,255,.4);--glow:rgba(0,212,255,.2);--cursor-color:#00d4ff}
body.theme-midnight{--bg:#0a0e27;--acc:#00d4ff;--cursor-color:#00d4ff;--glow:rgba(0,212,255,.2)}
body.theme-neon{--bg:#000814;--acc:#ff00ff;--glow:rgba(255,0,255,.2);--cursor-color:#ff00ff}
body.theme-aurora{--bg:#0a1a2d;--acc:#00ffaa;--glow:rgba(0,255,170,.2);--cursor-color:#00ffaa}
body.theme-sunset{--bg:#1a0e1a;--acc:#ff6b35;--glow:rgba(255,107,53,.2);--cursor-color:#ff6b35}
body.theme-cyber{--bg:#0d0d1a;--acc:#00ffff;--glow:rgba(0,255,255,.2);--cursor-color:#00ffff}
html,body{width:100%;height:100vh;font-family:Inter,sans-serif;overflow:hidden}
body{background:var(--bg);color:var(--txt);transition:background .3s}
body,body *{cursor:none!important;user-select:none}
body.logged-in #os{opacity:1;pointer-events:auto}
#loading-screen{position:fixed;inset:0;background:linear-gradient(135deg,var(--bg),var(--bg3));z-index:999999;display:flex;flex-direction:column;align-items:center;justify-content:center;transition:opacity .8s}
#loading-screen.hidden{opacity:0;visibility:hidden;pointer-events:none}
.loading-logo{width:200px;height:200px;margin-bottom:50px;animation:float 3s ease-in-out infinite}
@keyframes float{0%,100%{transform:translateY(0) rotate(0deg)}50%{transform:translateY(-30px) rotate(180deg)}}
.loading-logo svg{width:100%;height:100%;filter:drop-shadow(0 0 60px var(--glow))}
.loading-text{font-family:Orbitron,sans-serif;font-size:64px;font-weight:900;background:linear-gradient(135deg,var(--acc),#6fe7ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:30px;letter-spacing:12px;animation:glow 2s ease-in-out infinite}
@keyframes glow{0%,100%{filter:drop-shadow(0 0 20px var(--glow))}50%{filter:drop-shadow(0 0 50px var(--glow))}}
.loading-bar{width:600px;height:12px;background:rgba(255,255,255,.1);border-radius:20px;overflow:hidden;margin-top:40px;box-shadow:0 0 40px rgba(0,0,0,.6)}
.loading-progress{height:100%;background:linear-gradient(90deg,var(--acc),#00a8ff,var(--acc));background-size:200% 100%;width:0%;transition:width .5s;border-radius:20px;animation:shimmer 2s linear infinite;box-shadow:0 0 30px var(--acc)}
@keyframes shimmer{to{background-position:200% 0}}
.loading-stats{margin-top:25px;font-size:18px;color:var(--txt2);font-weight:700;font-family:'Fira Code',monospace}
.app-loader{position:absolute;inset:0;background:rgba(10,14,39,.98);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:1000;transition:opacity .5s;backdrop-filter:blur(15px)}
.app-loader.hidden{opacity:0;pointer-events:none}
.spinner{width:80px;height:80px;border:6px solid var(--border);border-top-color:var(--acc);border-radius:50%;animation:spin 1s linear infinite;box-shadow:0 0 40px var(--glow)}
@keyframes spin{to{transform:rotate(360deg)}}
.app-loader-text{margin-top:30px;font-size:22px;color:var(--txt);font-weight:700;font-family:Orbitron,sans-serif;text-shadow:0 0 20px var(--glow)}
#cursor{position:fixed;pointer-events:none;z-index:999999;display:none;transform:translate(-50%, -50%)}
body.logged-in #cursor{display:block}
.cursor-pointer{width:0;height:0;border-left:14px solid transparent;border-right:14px solid transparent;border-bottom:24px solid var(--cursor-color);transform:rotate(-45deg);filter:drop-shadow(0 0 12px var(--cursor-color)) drop-shadow(0 0 25px var(--glow));position:relative;transition:all .12s ease}
.cursor-pointer::after{content:'';position:absolute;top:24px;left:-7px;width:14px;height:5px;background:var(--cursor-color);box-shadow:0 0 18px var(--cursor-color)}
#cursor.hover .cursor-pointer{border-bottom-color:#fff;transform:rotate(-45deg) scale(1.5);filter:drop-shadow(0 0 20px #fff) drop-shadow(0 0 35px rgba(255,255,255,.9))}
#cursor.hover .cursor-pointer::after{background:#fff;box-shadow:0 0 25px #fff}
#cursor.click .cursor-pointer{transform:rotate(-45deg) scale(0.8)}
#disguise{position:fixed;inset:0;z-index:99999;background:#f0f2f5;font-family:system-ui;transition:opacity .5s;cursor:default!important}
#disguise.hide{opacity:0;pointer-events:none}
body.logged-in #disguise{display:none}
#disguise *{cursor:default!important}
.edu-wrap{max-width:1200px;margin:0 auto;padding:40px 20px;min-height:100vh}
.edu-header{background:linear-gradient(135deg,#1a237e,#283593);border-radius:20px;padding:40px;display:flex;gap:30px;margin-bottom:40px;color:#fff;box-shadow:0 10px 40px rgba(0,0,0,.3)}
.edu-logo{width:80px;height:80px;border-radius:20px;background:#fff;color:#1a237e;display:flex;align-items:center;justify-content:center;font-size:36px;font-weight:800;box-shadow:0 4px 12px rgba(0,0,0,.2)}
.edu-hero{background:#fff;border-radius:20px;padding:50px;box-shadow:0 10px 40px rgba(0,0,0,.15)}
.edu-hero h2{color:#1a237e;font-size:32px;margin-bottom:20px;font-weight:700}
.edu-hero p{color:#546e7a;font-size:18px;margin-bottom:30px;line-height:1.6}
#unlock-trigger{background:linear-gradient(135deg,#1a237e,#283593);border:none;border-radius:18px;padding:20px 36px;cursor:pointer!important;color:#fff;font-weight:600;font-size:16px;display:flex;flex-direction:column;align-items:center;min-height:120px;box-shadow:0 10px 30px rgba(26,35,126,.5);transition:all .3s;justify-content:center}
#unlock-trigger:hover{transform:translateY(-6px);box-shadow:0 15px 40px rgba(26,35,126,.6)}
.unlock-status{font-size:13px;opacity:.9;margin-top:10px}
#login-screen{position:fixed;inset:0;z-index:99998;background:linear-gradient(135deg,var(--bg),var(--bg3));display:none;align-items:center;justify-content:center}
#login-screen.show{display:flex}
body.logged-in #login-screen{display:none}
.login-container{background:var(--bg2);border:2px solid var(--border-acc);border-radius:24px;padding:60px;max-width:500px;width:90%;text-align:center;box-shadow:0 30px 100px rgba(0,0,0,.8)}
.login-logo{width:150px;height:150px;margin:0 auto 30px}
.login-logo svg{width:100%;height:100%;filter:drop-shadow(0 0 50px var(--glow));animation:pulse 2s infinite}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.08)}}
.login-title{font-family:Orbitron,sans-serif;font-size:48px;font-weight:900;background:linear-gradient(135deg,var(--acc),#6fe7ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:12px;text-shadow:0 0 40px var(--glow)}
.login-subtitle{font-size:16px;color:var(--txt2);margin-bottom:40px;font-weight:600}
.login-form{display:flex;flex-direction:column;gap:20px}
.input-group input{width:100%;background:var(--bg3);border:2px solid var(--border);border-radius:12px;padding:20px 24px;font-size:16px;color:var(--txt);font-family:Inter,sans-serif;transition:all .3s}
.input-group input:focus{outline:none;border-color:var(--acc);box-shadow:0 0 0 4px var(--glow);transform:translateY(-3px)}
.input-group input::placeholder{color:var(--txt2)}
.login-btn{background:linear-gradient(135deg,var(--acc),rgba(0,212,255,.9));border:none;border-radius:12px;padding:22px;font-size:18px;font-weight:700;color:var(--bg);cursor:pointer!important;text-transform:uppercase;letter-spacing:2px;transition:all .3s;box-shadow:0 12px 40px var(--glow)}
.login-btn:hover{transform:translateY(-5px);box-shadow:0 18px 50px var(--glow)}
.login-error{background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.3);border-radius:8px;padding:14px;color:#ef4444;font-size:14px;display:none;font-weight:600}
.login-error.show{display:block}
#os{position:fixed;inset:0;display:flex;flex-direction:column;opacity:0;pointer-events:none;transition:opacity .6s}
#desktop-bg{position:fixed;inset:0;z-index:0;transition:background .5s}
#desktop-bg.bg-gradient{background:linear-gradient(135deg,#0a0e27 0%,#1e2749 100%)}
#desktop-bg.bg-stars{background:#000;background-image:radial-gradient(white,rgba(255,255,255,.3) 2px,transparent 3px),radial-gradient(white,rgba(255,255,255,.2) 1px,transparent 2px);background-size:550px 550px,350px 350px;background-position:0 0,40px 60px;animation:stars 200s linear infinite}
@keyframes stars{to{transform:translateY(550px)}}
#desktop-bg.bg-waves{background:radial-gradient(circle at 20% 80%,rgba(0,212,255,.25) 0%,transparent 50%),radial-gradient(circle at 80% 20%,rgba(168,85,247,.25) 0%,transparent 50%),var(--bg)}
#desktop-bg.bg-aurora{background:linear-gradient(135deg,#0a1a2d 0%,#1f3a6d 50%,#00ffaa 100%)}
#desktop-bg.bg-sunset{background:linear-gradient(135deg,#1a0e1a 0%,#3d2340 50%,#ff6b35 100%)}
#desktop-bg.bg-matrix{background:#001100;background-image:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,255,0,.04) 2px,rgba(0,255,0,.04) 4px)}
#desktop-bg.bg-neon{background:#000;background-image:radial-gradient(circle,rgba(255,0,255,.2) 2px,transparent 2px);background-size:60px 60px}
.peak-logo-bg{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;opacity:.05;pointer-events:none}
.peak-logo-text{font-family:Orbitron,sans-serif;font-size:18vw;font-weight:900;color:var(--acc);text-shadow:0 0 100px var(--glow)}
#desktop{position:relative;z-index:2;flex:1;padding:30px;overflow:hidden;display:grid;grid-template-columns:1fr 360px;gap:30px}
#desktop.sidebar-hidden{grid-template-columns:1fr}
#desktop.sidebar-hidden .desktop-widgets{display:none}
.desktop-icons-area{display:grid;grid-template-columns:repeat(auto-fill,120px);gap:25px;align-content:start;grid-auto-rows:120px}
.desktop-icon{display:flex;flex-direction:column;align-items:center;gap:10px;padding:14px;border-radius:18px;cursor:pointer;background:rgba(255,255,255,.06);border:2px solid transparent;height:120px;width:120px;transition:all .3s;position:relative;backdrop-filter:blur(15px);box-shadow:0 4px 15px rgba(0,0,0,.3)}
.desktop-icon:hover{background:rgba(255,255,255,.18);border-color:var(--border-acc);transform:translateY(-10px) scale(1.12);box-shadow:0 25px 70px rgba(0,0,0,.8),0 0 40px var(--glow)}
.desktop-icon-img{width:52px;height:52px;display:flex;align-items:center;justify-content:center;font-size:42px;filter:drop-shadow(0 3px 6px rgba(0,0,0,.4))}
.desktop-icon-label{font-size:12px;color:var(--txt);text-align:center;font-weight:700;padding:6px 10px;border-radius:10px;background:rgba(0,0,0,.7);max-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;backdrop-filter:blur(15px);box-shadow:0 2px 10px rgba(0,0,0,.5)}
/* hideable sidebar toggle button */
.sidebar-toggle{position:absolute;top:40px;right:40px;z-index:20;width:48px;height:48px;border-radius:50%;background:var(--bg3);border:2px solid var(--border-acc);color:var(--acc);font-size:24px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s;box-shadow:0 8px 28px rgba(0,0,0,.6)}
.sidebar-toggle:hover{transform:scale(1.2);background:var(--acc);color:var(--bg);box-shadow:0 0 40px var(--glow)}
.desktop-widgets{display:flex;flex-direction:column;gap:24px}
.widget{background:rgba(21,27,61,.9);border:2px solid var(--border-acc);border-radius:24px;padding:28px;backdrop-filter:blur(30px);box-shadow:0 12px 50px rgba(0,0,0,.6),inset 0 1px 0 rgba(255,255,255,.15);transition:all .3s}
.widget:hover{transform:translateY(-8px);box-shadow:0 20px 70px rgba(0,0,0,.8),0 0 50px var(--glow)}
.widget-title{font-size:18px;font-weight:700;color:var(--acc);margin-bottom:20px;display:flex;align-items:center;gap:12px;text-shadow:0 0 15px var(--glow)}
.clock-widget{font-family:Orbitron,sans-serif;text-align:center}
.clock-time{font-size:56px;font-weight:900;color:var(--txt);letter-spacing:3px;text-shadow:0 0 30px var(--glow),0 3px 6px rgba(0,0,0,.6)}
.clock-date{font-size:18px;color:var(--txt2);margin-top:12px;font-weight:600}
.quick-launch{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-top:16px}
.quick-btn{aspect-ratio:1;background:var(--bg3);border:2px solid var(--border);border-radius:16px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:8px;font-size:28px;cursor:pointer;transition:all .3s;box-shadow:0 6px 18px rgba(0,0,0,.4)}
.quick-btn:hover{background:linear-gradient(135deg,var(--glow),var(--bg3));border-color:var(--acc);transform:translateY(-8px) scale(1.1);box-shadow:0 15px 45px rgba(0,0,0,.7),0 0 35px var(--glow)}
.quick-btn-label{font-size:10px;color:var(--txt2);font-weight:700;text-transform:uppercase;letter-spacing:1px}
.system-monitor{font-size:14px}
.monitor-item{display:flex;justify-content:space-between;margin-bottom:14px;padding:12px;background:var(--bg3);border-radius:12px;border:1px solid var(--border);transition:all .3s}
.monitor-item:hover{background:rgba(255,255,255,.08);border-color:var(--border-acc);transform:translateX(6px);box-shadow:0 4px 15px rgba(0,0,0,.4)}
.monitor-label{color:var(--txt2);font-weight:600}
.monitor-value{color:var(--acc);font-weight:700;font-family:'Fira Code',monospace;text-shadow:0 0 10px var(--glow)}
.window{position:absolute;background:var(--bg2);border:2px solid var(--border-acc);border-radius:24px;box-shadow:0 50px 120px rgba(0,0,0,.9),0 0 80px var(--glow);display:flex;flex-direction:column;opacity:0;pointer-events:none;min-width:650px;min-height:550px;overflow:hidden;transition:all .3s;backdrop-filter:blur(35px)}
.window.show{opacity:1;pointer-events:auto;z-index:100;animation:windowAppear .6s cubic-bezier(.34,1.56,.64,1)}
@keyframes windowAppear{0%{opacity:0;transform:scale(.88) translateY(70px)}100%{opacity:1;transform:scale(1) translateY(0)}}
.window.maximized{top:0!important;left:0!important;right:0!important;bottom:80px!important;width:100%!important;height:calc(100% - 80px)!important;border-radius:0}
.window.minimized{opacity:0;pointer-events:none;transform:scale(0.7) translateY(150px)}
.window-titlebar{display:flex;align-items:center;gap:14px;padding:16px 22px;background:linear-gradient(135deg,var(--bg3),var(--bg2));border-bottom:2px solid var(--border-acc);cursor:move;user-select:none;box-shadow:0 3px 12px rgba(0,0,0,.4)}
.window-title{flex:1;font-size:16px;font-weight:700;color:var(--txt);text-shadow:0 1px 3px rgba(0,0,0,.6)}
.window-controls{display:flex;gap:10px}
.window-btn{width:36px;height:36px;border-radius:10px;background:rgba(255,255,255,.1);border:2px solid var(--border);color:var(--txt2);cursor:pointer;font-size:16px;display:flex;align-items:center;justify-content:center;transition:all .3s;font-weight:700}
.window-btn:hover{background:rgba(255,255,255,.25);color:var(--txt);transform:translateY(-4px) scale(1.12);box-shadow:0 8px 24px rgba(0,0,0,.5)}
.window-btn.close:hover{background:#ef4444;color:#fff;border-color:#ef4444;box-shadow:0 8px 28px rgba(239,68,68,.7)}
.tab-content{display:none;flex:1;overflow:hidden;position:relative}
.tab-content.active{display:flex;flex-direction:column}
.content-grid{flex:1;overflow-y:auto;padding:32px}
.content-grid::-webkit-scrollbar{width:12px}
.content-grid::-webkit-scrollbar-thumb{background:var(--border-acc);border-radius:10px;border:2px solid var(--bg2)}
.content-grid::-webkit-scrollbar-track{background:var(--bg3)}
.grid-title{font-size:36px;font-weight:900;font-family:Orbitron,sans-serif;background:linear-gradient(135deg,var(--acc),#6fe7ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:10px;text-shadow:0 0 40px var(--glow)}
.grid-subtitle{font-size:16px;color:var(--txt2);margin-bottom:35px;font-weight:600}
.grid-btn{padding:14px 28px;background:var(--bg3);border:2px solid var(--border);border-radius:14px;color:var(--txt);cursor:pointer;display:inline-flex;align-items:center;gap:12px;font-size:14px;font-weight:700;transition:all .3s;white-space:nowrap;box-shadow:0 6px 18px rgba(0,0,0,.4)}
.grid-btn:hover{background:rgba(255,255,255,.15);border-color:var(--border-acc);transform:translateY(-6px);box-shadow:0 12px 35px rgba(0,0,0,.6)}
.grid-btn.primary{background:linear-gradient(135deg,var(--acc),rgba(0,212,255,.9));color:var(--bg);border:none;box-shadow:0 10px 35px var(--glow)}
.grid-btn.primary:hover{transform:translateY(-6px) scale(1.05);box-shadow:0 18px 50px var(--glow)}
.grid-btn.success{background:#10b981;color:#fff;border:none;box-shadow:0 8px 28px rgba(16,185,129,.5)}
.grid-btn.danger{background:#ef4444;color:#fff;border:none;box-shadow:0 8px 28px rgba(239,68,68,.5)}
.item-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:24px}
.item-card{background:var(--bg3);border:2px solid var(--border);border-radius:20px;padding:26px;display:flex;flex-direction:column;gap:18px;transition:all .3s;position:relative;overflow:hidden;box-shadow:0 8px 28px rgba(0,0,0,.4)}
.item-card::before{content:'';position:absolute;inset:0;background:linear-gradient(135deg,var(--glow),transparent);opacity:0;transition:opacity .3s}
.item-card:hover{border-color:var(--border-acc);transform:translateY(-12px) scale(1.03);box-shadow:0 30px 80px rgba(0,0,0,.8),0 0 50px var(--glow)}
.item-card:hover::before{opacity:1}
.item-header{display:flex;gap:18px;position:relative;z-index:1}
.item-icon{font-size:44px;filter:drop-shadow(0 3px 6px rgba(0,0,0,.4))}
.item-name{font-size:18px;font-weight:700}
.item-desc{font-size:14px;color:var(--txt2);font-weight:500}
.item-actions{display:flex;gap:12px;flex-wrap:wrap;position:relative;z-index:1}
.context-menu{position:fixed;background:rgba(21,27,61,.98);border:2px solid var(--border-acc);border-radius:18px;padding:12px;z-index:10001;min-width:240px;opacity:0;pointer-events:none;transform:scale(.9);transition:all .3s;box-shadow:0 50px 120px rgba(0,0,0,.9),0 0 80px var(--glow);backdrop-filter:blur(35px)}
.context-menu.show{opacity:1;pointer-events:auto;transform:scale(1)}
.context-item{padding:14px 18px;border-radius:12px;cursor:pointer;display:flex;align-items:center;gap:16px;font-size:15px;color:var(--txt);transition:all .3s;font-weight:600}
.context-item:hover{background:var(--glow);transform:translateX(10px);box-shadow:0 6px 18px rgba(0,0,0,.4)}
.context-divider{height:2px;background:var(--border);margin:10px 0}
#quick-settings{position:fixed;bottom:92px;right:24px;width:420px;background:rgba(21,27,61,.98);border:2px solid var(--border-acc);border-radius:26px;padding:32px;opacity:0;pointer-events:none;transform:translateY(50px);transition:all .4s;z-index:199;box-shadow:0 50px 120px rgba(0,0,0,.9),0 0 80px var(--glow);backdrop-filter:blur(35px)}
#quick-settings.show{opacity:1;pointer-events:auto;transform:translateY(0)}
.qs-header{font-size:24px;font-weight:700;margin-bottom:28px;padding-bottom:18px;border-bottom:2px solid var(--border);color:var(--acc);text-shadow:0 0 20px var(--glow)}
.qs-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-bottom:28px}
.qs-tile{aspect-ratio:1;background:var(--bg3);border:2px solid var(--border);border-radius:18px;cursor:pointer;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;transition:all .3s;box-shadow:0 6px 20px rgba(0,0,0,.4)}
.qs-tile:hover{transform:translateY(-10px) scale(1.08);box-shadow:0 18px 50px rgba(0,0,0,.7)}
.qs-tile.active{background:linear-gradient(135deg,var(--acc),rgba(0,212,255,.9));color:var(--bg);border-color:var(--acc);box-shadow:0 12px 40px var(--glow)}
.qs-tile-icon{font-size:36px}
.qs-tile-label{font-size:12px;font-weight:700;text-transform:uppercase;letter-spacing:1px}
.qs-slider{margin-bottom:24px}
.qs-slider-label{font-size:15px;color:var(--txt2);margin-bottom:12px;display:flex;justify-content:space-between;font-weight:700}
.qs-slider-input{width:100%;height:10px;background:var(--bg3);border-radius:10px;outline:none;-webkit-appearance:none;box-shadow:inset 0 2px 6px rgba(0,0,0,.4)}
.qs-slider-input::-webkit-slider-thumb{-webkit-appearance:none;width:26px;height:26px;border-radius:50%;background:var(--acc);cursor:pointer;box-shadow:0 8px 24px var(--glow);transition:all .2s}
.qs-slider-input::-webkit-slider-thumb:hover{transform:scale(1.4);box-shadow:0 12px 35px var(--glow)}
#taskbar{position:fixed;bottom:0;left:0;right:0;height:80px;z-index:200;background:rgba(21,27,61,.98);backdrop-filter:blur(40px);border-top:3px solid var(--border-acc);display:flex;align-items:center;padding:0 24px;gap:18px;box-shadow:0 -12px 50px rgba(0,0,0,.8)}
.start-btn{width:64px;height:64px;border-radius:18px;background:linear-gradient(135deg,var(--acc),rgba(0,212,255,.9));border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .4s;box-shadow:0 12px 45px var(--glow)}
.start-btn:hover{transform:scale(1.3) rotate(30deg);box-shadow:0 20px 70px var(--glow)}
.start-btn svg{width:36px;height:36px}
.taskbar-windows{display:flex;gap:10px;flex:1;overflow-x:auto;padding:0 14px}
.taskbar-windows::-webkit-scrollbar{height:8px}
.taskbar-windows::-webkit-scrollbar-thumb{background:var(--border-acc);border-radius:10px;border:2px solid var(--bg2)}
.taskbar-window-btn{padding:14px 20px;background:var(--bg3);border:2px solid var(--border);border-radius:16px;cursor:pointer;display:flex;align-items:center;gap:14px;min-width:200px;max-width:260px;transition:all .3s;position:relative;box-shadow:0 6px 20px rgba(0,0,0,.4)}
.taskbar-window-btn:hover{background:rgba(255,255,255,.18);transform:translateY(-8px);box-shadow:0 14px 45px rgba(0,0,0,.7)}
.taskbar-window-btn.active{background:linear-gradient(135deg,var(--glow),var(--bg3));border-color:var(--acc);box-shadow:0 10px 35px var(--glow)}
.taskbar-window-icon{font-size:22px}
.taskbar-window-title{flex:1;font-size:14px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:var(--txt2);font-weight:700;padding-right:10px}
.taskbar-window-btn.active .taskbar-window-title{color:var(--txt)}
.taskbar-close-btn{width:28px;height:28px;border-radius:50%;background:rgba(255,255,255,.18);border:2px solid var(--border);color:var(--txt2);font-size:18px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s;font-weight:700;flex-shrink:0}
.taskbar-close-btn:hover{background:#ef4444;border-color:#ef4444;color:#fff;transform:scale(1.5) rotate(90deg);box-shadow:0 8px 24px rgba(239,68,68,.8)}
.taskbar-end{display:flex;align-items:center;gap:18px;margin-left:auto}
.taskbar-clock{padding:14px 28px;text-align:center;cursor:pointer;border-radius:16px;transition:all .3s;background:var(--bg3);border:2px solid var(--border);box-shadow:0 6px 20px rgba(0,0,0,.4)}
.taskbar-clock:hover{background:rgba(255,255,255,.15);transform:translateY(-8px);box-shadow:0 14px 45px rgba(0,0,0,.7);border-color:var(--border-acc)}
.clock-time{font-size:18px;font-weight:700;font-family:Orbitron,monospace;letter-spacing:2px}
.clock-date{font-size:12px;color:var(--txt2);margin-top:5px;font-weight:700}
#toast-container{position:fixed;top:35px;right:35px;z-index:9999;display:flex;flex-direction:column;gap:18px;pointer-events:none}
.toast{background:rgba(21,27,61,.98);border:2px solid var(--border-acc);border-radius:18px;padding:22px 26px;min-width:360px;display:flex;gap:18px;transform:translateX(600px);transition:all .7s cubic-bezier(.68,-.55,.265,1.55);opacity:0;box-shadow:0 50px 120px rgba(0,0,0,.9),0 0 80px var(--glow);backdrop-filter:blur(35px);pointer-events:auto}
.toast.show{transform:translateX(0);opacity:1}
.toast-icon{font-size:28px;width:46px;height:46px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,.18);border-radius:14px;box-shadow:0 6px 18px rgba(0,0,0,.4)}
.toast-title{font-size:17px;font-weight:700}
.toast-msg{font-size:14px;color:var(--txt2);margin-top:5px;font-weight:600}
.nav-btn{width:100%;justify-content:flex-start;font-size:15px}
.nav-btn.active{background:linear-gradient(135deg,var(--acc),rgba(0,212,255,.9));color:var(--bg);border:none;box-shadow:0 8px 28px var(--glow)}
.hub-tab{display:none}
.hub-tab.active{display:block}
.color-picker{display:grid;grid-template-columns:repeat(6,1fr);gap:14px;margin-top:24px}
.color-swatch{width:100%;aspect-ratio:1;border-radius:14px;cursor:pointer;border:4px solid transparent;transition:all .3s;box-shadow:0 8px 24px rgba(0,0,0,.6)}
.color-swatch:hover{transform:scale(1.25) rotate(8deg);box-shadow:0 14px 40px rgba(0,0,0,.8)}
.color-swatch.active{border-color:#fff;box-shadow:0 0 40px currentColor,0 14px 50px rgba(0,0,0,.9);transform:scale(1.2)}
</style>
</head>
<body class="theme-midnight">

<div id="loading-screen">
<div class="loading-logo">
<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
<linearGradient id="lg" x1="0%" y1="0%" x2="100%" y2="100%">
<stop offset="0%" style="stop-color:#00d4ff"/>
<stop offset="100%" style="stop-color:rgba(0,212,255,.6)"/>
</linearGradient>
<path d="M 50 10 L 70 50 L 90 90 L 10 90 L 30 50 Z" fill="url(#lg)"/>
<path d="M 50 10 L 60 30 L 50 35 L 40 30 Z" fill="#fff"/>
</svg>
</div>
<div class="loading-text">PEAK HUB</div>
<div class="loading-stats" id="loading-stats">Initializing System...</div>
<div class="loading-bar"><div class="loading-progress" id="loading-progress"></div></div>
</div>

<div id="cursor"><div class="cursor-pointer"></div></div>

<div id="disguise">
<div class="edu-wrap">
<div class="edu-header">
<div class="edu-logo">HS</div>
<div><h1 style="font-size:36px">Hillside Secondary School</h1><p>Student Academic Portal ‚Ä¢ District Learning System</p></div>
</div>
<div class="edu-hero">
<h2>Welcome Back, Student!</h2>
<p>Access your classes, view assignments, and connect with teachers through our integrated learning platform.</p>
<button id="unlock-trigger">üîì Initialize Session<div class="unlock-status" id="unlock-status">Click 3 times to unlock</div></button>
</div>
</div>
</div>

<div id="login-screen">
<div class="login-container">
<div class="login-logo">
<svg viewBox="0 0 100 100"><path d="M 50 10 L 70 50 L 90 90 L 10 90 L 30 50 Z" fill="var(--acc)"/><path d="M 50 10 L 60 30 L 50 35 L 40 30 Z" fill="#fff"/></svg>
</div>
<div class="login-title">PEAK HUB</div>
<div class="login-subtitle" id="login-subtitle">Enter your credentials to continue</div>
<form class="login-form" id="login-form">
<div class="login-error" id="login-error"></div>
<div class="input-group"><input type="text" id="username-input" placeholder="Username" autocomplete="off"></div>
<div class="input-group"><input type="password" id="password-input" placeholder="Password" autocomplete="off"></div>
<button type="submit" class="login-btn">LOGIN</button>
</form>
</div>
</div>

<div id="os">
<div id="desktop-bg" class="bg-gradient"><div class="peak-logo-bg"><div class="peak-logo-text">PEAK</div></div></div>
<div id="desktop">
<div class="sidebar-toggle" id="sidebarToggle" title="Toggle widgets">‚óÄ</div>
<div class="desktop-icons-area" id="desktop-icons"></div>
<div class="desktop-widgets">
<div class="widget clock-widget">
<div class="widget-title">üïê Live Time</div>
<div class="clock-time" id="widget-time">--:--</div>
<div class="clock-date" id="widget-date">Loading...</div>
</div>
<div class="widget">
<div class="widget-title">‚ö° Quick Launch</div>
<div class="quick-launch">
<div class="quick-btn" onclick="openApp('hub')"><div>üèîÔ∏è</div><div class="quick-btn-label">Hub</div></div>
<div class="quick-btn" onclick="openApp('styles')"><div>üé®</div><div class="quick-btn-label">Styles</div></div>
<div class="quick-btn" onclick="openTool('browser')"><div>üåç</div><div class="quick-btn-label">Browser</div></div>
<div class="quick-btn" onclick="openTool('notes')"><div>üìù</div><div class="quick-btn-label">Notes</div></div>
<div class="quick-btn" onclick="openTool('music')"><div>üéµ</div><div class="quick-btn-label">Music</div></div>
<div class="quick-btn" onclick="openTool('calculator')"><div>üî¢</div><div class="quick-btn-label">Calc</div></div>
</div>
</div>
<div class="widget">
<div class="widget-title">üìä System Monitor</div>
<div class="system-monitor">
<div class="monitor-item"><span class="monitor-label">Apps Installed</span><span class="monitor-value" id="apps-count">0</span></div>
<div class="monitor-item"><span class="monitor-label">Windows Open</span><span class="monitor-value" id="windows-count">0</span></div>
<div class="monitor-item"><span class="monitor-label">Active Theme</span><span class="monitor-value" id="theme-name">Midnight</span></div>
</div>
</div>
</div>
</div>
<div id="windows-container"></div>

<div class="context-menu" id="context-menu">
<div class="context-item" data-action="open"><span style="width:24px">‚ñ∂</span><span>Open</span></div>
<div class="context-item" data-action="rename"><span style="width:24px">‚úé</span><span>Rename</span></div>
<div class="context-divider"></div>
<div class="context-item" data-action="delete" style="color:#ef4444"><span style="width:24px">üóë</span><span>Delete</span></div>
</div>

<div id="quick-settings">
<div class="qs-header">‚öôÔ∏è Quick Settings</div>
<div class="qs-grid">
<div class="qs-tile" onclick="toggleQS('wifi')"><div class="qs-tile-icon">üì∂</div><div class="qs-tile-label">WiFi</div></div>
<div class="qs-tile" onclick="toggleQS('airplane')"><div class="qs-tile-icon">‚úàÔ∏è</div><div class="qs-tile-label">Airplane</div></div>
<div class="qs-tile" onclick="toggleQS('bt')"><div class="qs-tile-icon">üì°</div><div class="qs-tile-label">Bluetooth</div></div>
</div>
<div class="qs-slider">
<div class="qs-slider-label"><span>üîä Volume</span><span id="vol-val">50%</span></div>
<input type="range" class="qs-slider-input" id="vol-slider" min="0" max="100" value="50">
</div>
<div class="qs-slider">
<div class="qs-slider-label"><span>üí° Brightness</span><span id="bright-val">75%</span></div>
<input type="range" class="qs-slider-input" id="bright-slider" min="0" max="100" value="75">
</div>
</div>

<div id="taskbar">
<div class="taskbar-start">
<button class="start-btn" id="start-btn" title="Peak Hub">
<svg viewBox="0 0 100 100"><path d="M 50 10 L 70 50 L 90 90 L 10 90 L 30 50 Z" fill="currentColor"/><path d="M 50 10 L 60 30 L 50 35 L 40 30 Z" fill="#fff"/></svg>
</button>
</div>
<div class="taskbar-windows" id="taskbar-windows"></div>
<div class="taskbar-end">
<div class="taskbar-clock" id="taskbar-clock" title="Click for Quick Settings">
<div class="clock-time">--:--</div>
<div class="clock-date">---</div>
</div>
</div>
</div>
</div>

<div id="toast-container"></div>

<script>
const $=s=>document.querySelector(s),$$=s=>[...document.querySelectorAll(s)];
const loadData=(k,d)=>{try{return JSON.parse(localStorage.getItem('ph-'+k)||JSON.stringify(d))}catch{return d}};
const saveData=(k,d)=>localStorage.setItem('ph-'+k,JSON.stringify(d));

let settings=loadData('settings',{theme:'midnight',bg:'gradient',cursor:'#00d4ff',sidebarHidden:false}),currentUser=null,unlockClicks=0,windows=[],winId=0,activeWin=null,contextTarget=null;

const TOOLS=[
{id:'notes',icon:'üìù',name:'Notes',cat:'Productivity'},
{id:'calculator',icon:'üî¢',name:'Calculator',cat:'Tools'},
{id:'music',icon:'üéµ',name:'Music Player',cat:'Media'},
{id:'browser',icon:'üåç',name:'Browser',cat:'Internet'},
{id:'files',icon:'üìÅ',name:'File Manager',cat:'System'},
{id:'sysinfo',icon:'üíª',name:'System Info',cat:'System'},
{id:'settings',icon:'‚öôÔ∏è',name:'Settings',cat:'System'},
{id:'terminal',icon:'‚å®Ô∏è',name:'Terminal',cat:'Developer'},
{id:'paint',icon:'üé®',name:'Paint',cat:'Creative'}
];

const GAMES=[
{id:'geometry-dash',icon:'üî∫',name:'Geometry Dash',cat:'Rhythm',url:'https://rawcdn.githack.com/genizy/google-class/main/gdlite/index.html'},
{id:'draw-joust',icon:'‚öîÔ∏è',name:'Draw Joust',cat:'Action',url:'https://rawcdn.githack.com/genizy/brainrot/main/draw-joust/index.html'},
{id:'code-editor',icon:'üíª',name:'Code Editor',cat:'Tools',url:'https://rawcdn.githack.com/genizy/code-editor/main/index.html'},
{id:'car-3d',icon:'üöó',name:'Destroy Car 3D',cat:'Action',url:'https://cdn.jsdelivr.net/gh/genizy/brainrot@main/destroy-the-car-3d/'},
{id:'city-defense',icon:'üè∞',name:'City Defense',cat:'Strategy',url:'https://rawcdn.githack.com/genizy/brainrot/main/city-defense/index.html'},
{id:'soundboard',icon:'üîä',name:'Soundboard',cat:'Audio',url:'https://rawcdn.githack.com/genizy/soundboard/main/index.html'},
{id:'diamond',icon:'üíé',name:'Diamond Seeker',cat:'Puzzle',url:'https://rawcdn.githack.com/genizy/brainrot/main/diamond-seeker/'},
{id:'flick-goal',icon:'‚öΩ',name:'Flick Goal',cat:'Sports',url:'https://rawcdn.githack.com/genizy/brainrot/main/flick-goal/'},
{id:'aquapark',icon:'üåä',name:'Aquapark.io',cat:'Racing',url:'https://cdn.jsdelivr.net/gh/bubbls/youtube-playables@main/aquapark-io/'},
{id:'polytrack',icon:'üèéÔ∏è',name:'Poly Track',cat:'Racing',url:'https://cdn.jsdelivr.net/gh/genizy/polytrack@latest/'},
{id:'escape-road',icon:'üöì',name:'Escape Road',cat:'Racing',url:'https://cdn.jsdelivr.net/gh/bubbls/escape-road@45b2d69c626dc365753f6922d2c48c4075683ef5/drive.google.com/escape%20road/'},
{id:'justfall',icon:'üé≤',name:'JustFall.lol',cat:'Multiplayer',url:'https://cdn.jsdelivr.net/gh/fork-so-the-site-i-take-wont-be-deleted/bulbasaurchat.github.io@main/games/justfalllol/'},
{id:'fnae',icon:'üêª',name:'Five Nights at Epstein',cat:'Horror',url:'https://cdn.jsdelivr.net/gh/web-ports/fnae@c9c8b513a27155bf37c4ab3dee74e99b12b895ba/'},
{id:'evolving-bombs',icon:'üí£',name:'Evolving Bombs 3D',cat:'Action',url:'https://rawcdn.githack.com/web-retro/assets/main/evolving-bombs-3d/'},
{id:'sandbox-city',icon:'üèôÔ∏è',name:'Sandbox City',cat:'Simulation',url:'https://cdn.jsdelivr.net/gh/faralong/all@main/sandboxcity/'},
{id:'slice-it-all',icon:'üî™',name:'Slice It All',cat:'Casual',url:'https://cdn.jsdelivr.net/gh/bubbls/youtube-playables@fea22b681fcc55bd6d5b059e2843120d3fbf7dd6/slice%20it%20all/'},
{id:'slope-plus',icon:'üéø',name:'Slope Plus',cat:'Racing',url:'https://cdn.jsdelivr.net/gh/gn-math/assets@51462750d29b68ac1e33887c1bf13d9c478d5ead/198/'},
{id:'snow-rider',icon:'üèÇ',name:'Snow Rider 3D',cat:'Racing',url:'https://cdn.jsdelivr.net/gh/Vrkids2009/snowrider3d@6b7c2b9167b592528b221428414e63f06c4640b9/'}
];

const PROXIES=[
{id:'truffled',name:'Truffled',icon:'üîµ',links:[{t:'Link 1',u:'https://educational.radissontucson.com/'},{t:'Link 2',u:'https://vacation.briaquaticcabinets.com/'}]},
{id:'overcloacked',name:'Overcloacked',icon:'‚ö°',links:[{t:'Link 1',u:'https://d58o0iyi.beanweb.qzz.io.cdn.cloudflare.net/'}]},
{id:'fern',name:'Fern',icon:'üåø',links:[{t:'Link 1',u:'https://apple1.vandrekalenderen.dk/'}]},
{id:'infamous',name:'Infamous',icon:'üî•',links:[{t:'Link 1',u:'https://team-anti-drugs.acgcotton.com/'}]},
{id:'void',name:'Void',icon:'üåå',links:[{t:'Link 1',u:'https://edu.ucecom-craiova.ro'}]}
];

let INSTALLED=loadData('installed',[]);

// AUTO-INSTALL SETTINGS - PROTECTED
if(!loadData('firstRun',false)){
INSTALLED.push({id:'settings',icon:'‚öôÔ∏è',name:'Settings',type:'tool',protected:true});
saveData('installed',INSTALLED);
saveData('firstRun',true);
}

const toast=(t,m,type='success')=>{
let c=$('#toast-container');
if(!c){c=document.createElement('div');c.id='toast-container';document.body.appendChild(c)}
const el=document.createElement('div');
el.className=`toast ${type}`;
el.innerHTML=`<div class="toast-icon">${type==='success'?'‚úì':'‚úï'}</div><div><div class="toast-title">${t}</div><div class="toast-msg">${m}</div></div>`;
c.appendChild(el);
setTimeout(()=>el.classList.add('show'),10);
setTimeout(()=>{el.classList.remove('show');setTimeout(()=>el.remove(),600)},4000);
};

// CUSTOM CURSOR - FIXED
const cursor=$('#cursor');
document.addEventListener('mousemove',e=>{
if(document.body.classList.contains('logged-in')){
cursor.style.left=e.clientX+'px';
cursor.style.top=e.clientY+'px';
}
});
document.addEventListener('mousedown',()=>cursor.classList.add('click'));
document.addEventListener('mouseup',()=>cursor.classList.remove('click'));

const bindHover=()=>{
$$('button,.desktop-icon,.window-btn,.item-card,.grid-btn,.taskbar-window-btn,.nav-btn,.context-item,.qs-tile,.color-swatch,.quick-btn,.taskbar-clock,.taskbar-close-btn,.sidebar-toggle').forEach(el=>{
if(el._hb)return;
el._hb=true;
el.addEventListener('mouseenter',()=>{if(document.body.classList.contains('logged-in'))cursor.classList.add('hover')});
el.addEventListener('mouseleave',()=>cursor.classList.remove('hover'));
});
};

$('#unlock-trigger').addEventListener('click',()=>{
unlockClicks++;
$('#unlock-status').textContent=unlockClicks>=3?'‚úì Unlocked!':`Click ${3-unlockClicks} more time${3-unlockClicks===1?'':'s'}`;
if(unlockClicks>=3){$('#disguise').classList.add('hide');setTimeout(()=>{$('#disguise').style.display='none';$('#login-screen').classList.add('show')},500)}
});

// APP LOADER FUNCTION
function showAppLoader(container){
const loader=document.createElement('div');
loader.className='app-loader';
loader.innerHTML='<div class="spinner"></div><div class="app-loader-text">Loading...</div>';
container.appendChild(loader);
return loader;
}

function createWin(title,icon,type,onReady){
const existing=windows.find(w=>w.type===type&&!w.min);
if(existing){restoreWin(existing.id);focusWin(existing.id);return existing.id}
const id=`win-${winId++}`;
const win=document.createElement('div');
win.className='window';
win.id=id;
win.style.top=(innerHeight/2-325)+'px';
win.style.left=(innerWidth/2-450)+'px';
win.style.width='900px';
win.style.height='650px';
win.innerHTML=`<div class="window-titlebar"><div class="window-title">${icon} ${title}</div><div class="window-controls"><button class="window-btn minimize" title="Minimize">‚àí</button><button class="window-btn maximize" title="Maximize">‚ñ°</button><button class="window-btn close" title="Close">‚úï</button></div></div><div class="tab-content active" id="content-${id}"></div>`;
$('#windows-container').appendChild(win);
if(typeof interact!=='undefined'){interact(win).draggable({allowFrom:'.window-titlebar',listeners:{move(e){const t=e.target;t.style.left=`${parseFloat(t.style.left)+e.dx}px`;t.style.top=`${parseFloat(t.style.top)+e.dy}px`}}})}
win.querySelector('.close').addEventListener('click',()=>closeWin(id));
win.querySelector('.minimize').addEventListener('click',()=>minWin(id));
win.querySelector('.maximize').addEventListener('click',()=>toggleMax(id));
win.addEventListener('mousedown',()=>focusWin(id));
windows.push({id,title,icon,type,min:false});
const content=$(`#content-${id}`);
const loader=showAppLoader(content);
setTimeout(()=>{
win.classList.add('show');
focusWin(id);
setTimeout(()=>{
if(onReady)onReady(content);
setTimeout(()=>loader.classList.add('hidden'),400);
},500);
},50);
updateTaskbar();
updateWidgets();
bindHover();
return id;
}

function closeWin(id){
const w=$(`#${id}`);
if(w){w.classList.remove('show');setTimeout(()=>w.remove(),300)}
windows=windows.filter(w=>w.id!==id);
updateTaskbar();
updateWidgets();
}

function minWin(id){
const w=$(`#${id}`);
if(w){w.classList.add('minimized');const wd=windows.find(w=>w.id===id);if(wd)wd.min=true}
updateTaskbar();
}

function restoreWin(id){
const w=$(`#${id}`);
if(w){w.classList.remove('minimized');const wd=windows.find(w=>w.id===id);if(wd)wd.min=false;focusWin(id)}
updateTaskbar();
}

function toggleMax(id){
const w=$(`#${id}`);
if(w)w.classList.toggle('maximized');
}

function focusWin(id){
$$('.window').forEach(w=>w.style.zIndex=100);
const w=$(`#${id}`);
if(w)w.style.zIndex=101;
activeWin=id;
updateTaskbar();
}

// ENHANCED TASKBAR WITH CLOSE BUTTONS
function updateTaskbar(){
const c=$('#taskbar-windows');
if(!c)return;
c.innerHTML=windows.map(w=>`<div class="taskbar-window-btn ${w.id===activeWin&&!w.min?'active':''}" data-id="${w.id}"><div class="taskbar-window-icon">${w.icon}</div><div class="taskbar-window-title">${w.title}</div><button class="taskbar-close-btn" onclick="event.stopPropagation();closeWin('${w.id}')">‚úï</button></div>`).join('');
$$('.taskbar-window-btn').forEach(btn=>{
const id=btn.dataset.id;
btn.addEventListener('click',()=>{const wd=windows.find(w=>w.id===id);if(wd&&wd.min)restoreWin(id);else focusWin(id)});
});
bindHover();
}

function updateClock(){
const now=new Date();
const time=now.toLocaleTimeString('en-US',{hour:'2-digit',minute:'2-digit'});
const date=now.toLocaleDateString('en-US',{weekday:'short',month:'short',day:'numeric'});
$$('.clock-time').forEach(el=>el.textContent=time);
$$('.clock-date').forEach(el=>el.textContent=date);
if($('#widget-time'))$('#widget-time').textContent=time;
if($('#widget-date'))$('#widget-date').textContent=date;
}

function updateWidgets(){
if($('#apps-count'))$('#apps-count').textContent=INSTALLED.length;
if($('#windows-count'))$('#windows-count').textContent=windows.length;
if($('#theme-name'))$('#theme-name').textContent=settings.theme.charAt(0).toUpperCase()+settings.theme.slice(1);
}

setInterval(updateClock,1000);

function initAuth(){
const users=loadData('users',[]);
const form=$('#login-form');
const loginBtn=form.querySelector('button');
let isSignup=users.length===0;
if(isSignup){loginBtn.textContent='CREATE ACCOUNT';$('#login-subtitle').textContent='Create your account to continue'}
const link=document.createElement('div');
link.style.marginTop='18px';
link.style.textAlign='center';
link.innerHTML='<a href="#" style="color:var(--acc);text-decoration:none;font-size:14px;font-weight:700" id="signup-link">Need an account? Create one</a>';
form.appendChild(link);
$('#signup-link').addEventListener('click',e=>{e.preventDefault();loginBtn.textContent='CREATE ACCOUNT';$('#login-subtitle').textContent='Create your account';isSignup=true});
form.addEventListener('submit',e=>{
e.preventDefault();
const user=$('#username-input').value.trim();
const pass=$('#password-input').value;
if(!user||!pass){showErr('Please fill in all fields');return}
if(isSignup){
if(user.length<3||pass.length<4){showErr('Username 3+ chars, password 4+ chars');return}
if(users.find(u=>u.username===user)){showErr('Username already exists');return}
users.push({username:user,password:pass});
saveData('users',users);
currentUser={username:user};
saveData('currentUser',currentUser);
loginOk();
}else{
const u=users.find(u=>u.username===user&&u.password===pass);
if(u){currentUser={username:user};saveData('currentUser',currentUser);loginOk()}else{showErr('Invalid username or password')}
}
});
function showErr(m){const e=$('#login-error');e.textContent=m;e.classList.add('show');setTimeout(()=>e.classList.remove('show'),4000)}
function loginOk(){$('#login-screen').classList.add('hide');setTimeout(()=>{document.body.classList.add('logged-in');$('#login-screen').style.display='none';initDesktop()},500)}
}

function renderDesktop(){
const icons=$('#desktop-icons');
icons.innerHTML='';
const hubIcon=makeIcon('hub','üèîÔ∏è','Peak Hub');
hubIcon.addEventListener('click',()=>openApp('hub'));
icons.appendChild(hubIcon);
const stylesIcon=makeIcon('styles','üé®','Styles');
stylesIcon.addEventListener('click',()=>openApp('styles'));
icons.appendChild(stylesIcon);
INSTALLED.forEach(app=>{
const icon=makeIcon(app.id,app.icon,app.name);
icon.addEventListener('click',()=>{
if(app.type==='game')launchGame(app);
else if(app.type==='proxy')launchProxy(app);
else if(app.type==='tool')openTool(app.id);
});
icon.addEventListener('contextmenu',e=>{e.preventDefault();showContext(e,app)});
icons.appendChild(icon);
});
updateWidgets();
}

function makeIcon(id,icon,label){
const el=document.createElement('div');
el.className='desktop-icon';
el.dataset.id=id;
el.innerHTML=`<div class="desktop-icon-img">${icon}</div><div class="desktop-icon-label">${label}</div>`;
return el;
}

function showContext(e,target){
e.preventDefault();
contextTarget=target;
const menu=$('#context-menu');
menu.style.left=e.clientX+'px';
menu.style.top=e.clientY+'px';
menu.classList.add('show');
setTimeout(()=>document.addEventListener('click',()=>menu.classList.remove('show'),{once:true}),10);
}

$$('.context-item').forEach(item=>{
item.addEventListener('click',()=>{
const action=item.dataset.action;
$('#context-menu').classList.remove('show');
if(!contextTarget)return;
if(action==='open'){
if(contextTarget.type==='game')launchGame(contextTarget);
else if(contextTarget.type==='proxy')launchProxy(contextTarget);
else if(contextTarget.type==='tool')openTool(contextTarget.id);
}else if(action==='rename'){
const newName=prompt('Enter new name:',contextTarget.name);
if(newName&&newName.trim()){contextTarget.name=newName.trim();saveData('installed',INSTALLED);renderDesktop();toast('Renamed! ‚úì',`App renamed to "${newName.trim()}"`)}
}else if(action==='delete'){
if(contextTarget.protected){toast('Cannot Delete! üîí','Settings app is protected','error');return}
if(confirm(`Delete "${contextTarget.name}"?`)){
INSTALLED=INSTALLED.filter(a=>a.id!==contextTarget.id);
saveData('installed',INSTALLED);
renderDesktop();
refreshHub();
toast('Deleted! üóëÔ∏è',`"${contextTarget.name}" removed`);
}
}
});
});

// SIDEBAR TOGGLE
const sidebarToggle=$('#sidebarToggle');
function updateSidebar(){
const desktop=$('#desktop');
if(settings.sidebarHidden){
desktop.classList.add('sidebar-hidden');
sidebarToggle.textContent='‚ñ∂';
}else{
desktop.classList.remove('sidebar-hidden');
sidebarToggle.textContent='‚óÄ';
}
saveData('settings',settings);
}
sidebarToggle.addEventListener('click',()=>{
settings.sidebarHidden=!settings.sidebarHidden;
updateSidebar();
});

function initDesktop(){
bindHover();
updateClock();
updateSidebar();
renderDesktop();
$('#start-btn').addEventListener('click',()=>openApp('hub'));
$('#taskbar-clock').addEventListener('click',()=>$('#quick-settings').classList.toggle('show'));
document.addEventListener('click',e=>{if(!e.target.closest('#quick-settings')&&!e.target.closest('#taskbar-clock'))$('#quick-settings').classList.remove('show')});
$('#vol-slider').addEventListener('input',e=>$('#vol-val').textContent=e.target.value+'%');
$('#bright-slider').addEventListener('input',e=>$('#bright-val').textContent=e.target.value+'%');
applySettings();
toast('Welcome! üéâ',`Welcome back, ${currentUser.username}!`);
}

function applySettings(){
document.body.className=document.body.className.replace(/theme-\w+/g,'');
document.body.classList.add(`theme-${settings.theme}`,'logged-in');
$('#desktop-bg').className=`bg-${settings.bg}`;
document.documentElement.style.setProperty('--cursor-color',settings.cursor);
updateSidebar();
saveData('settings',settings);
updateWidgets();
}

window.toggleQS=(type)=>{
event.currentTarget.classList.toggle('active');
const active=event.currentTarget.classList.contains('active');
toast(type.toUpperCase(),`${type.charAt(0).toUpperCase()+type.slice(1)} ${active?'enabled':'disabled'}`);
};

function openApp(id){
if(id==='hub')openHub();
else if(id==='styles')openStyles();
}


function openHub(){
createWin('Peak Hub','üèîÔ∏è','hub',content=>{
content.innerHTML=`
<div style="display:flex;height:100%">
<div style="width:240px;background:var(--bg3);border-right:2px solid var(--border-acc);padding:28px;display:flex;flex-direction:column">
<div style="margin-bottom:45px;text-align:center">
<svg viewBox="0 0 100 100" style="width:80px;height:80px;filter:drop-shadow(0 0 25px var(--glow))"><path d="M 50 10 L 70 50 L 90 90 L 10 90 L 30 50 Z" fill="currentColor"/><path d="M 50 10 L 60 30 L 50 35 L 40 30 Z" fill="#fff"/></svg>
<div style="font-family:Orbitron,sans-serif;font-size:22px;font-weight:900;color:var(--acc);margin-top:14px;text-shadow:0 0 15px var(--glow)">PEAK HUB</div>
<div style="font-size:11px;color:var(--txt2);margin-top:5px;font-weight:600;text-transform:uppercase;letter-spacing:2px">Ultimate Edition</div>
</div>
<div style="display:flex;flex-direction:column;gap:14px">
<button class="grid-btn nav-btn active" onclick="switchTab('games')">üéÆ Games</button>
<button class="grid-btn nav-btn" onclick="switchTab('proxies')">üåê Proxies</button>
<button class="grid-btn nav-btn" onclick="switchTab('tools')">üõ†Ô∏è Tools</button>
<button class="grid-btn nav-btn" onclick="switchTab('installed')">üì¶ Installed</button>
</div>
</div>
<div style="flex:1;display:flex;flex-direction:column">
<div class="hub-tab active" id="tab-games"><div class="content-grid"><div style="margin-bottom:35px"><div class="grid-title">Games Library</div><div class="grid-subtitle">${GAMES.length} games available ‚Ä¢ Install to play</div></div><div class="item-grid">${GAMES.map(g=>{
const inst=INSTALLED.find(a=>a.id===g.id);
return `<div class="item-card"><div class="item-header"><div class="item-icon">${g.icon}</div><div style="flex:1"><div class="item-name">${g.name}</div><div class="item-desc">${g.cat}</div></div></div><div class="item-actions">${inst?`<button class="grid-btn success" onclick='launchGame(${JSON.stringify(g)})'>üéÆ Play Now</button><button class="grid-btn danger" onclick='uninstallApp("${g.id}")'>üóëÔ∏è Remove</button>`:`<button class="grid-btn primary" onclick='installGame(${JSON.stringify(g)})'>üì• Install Game</button>`}</div></div>`;
}).join('')}</div></div></div>
<div class="hub-tab" id="tab-proxies"><div class="content-grid"><div style="margin-bottom:35px"><div class="grid-title">Proxy Network</div><div class="grid-subtitle">${PROXIES.length} secure proxy services ‚Ä¢ Multiple links</div></div><div class="item-grid">${PROXIES.map(p=>`<div class="item-card"><div class="item-header"><div class="item-icon">${p.icon}</div><div style="flex:1"><div class="item-name">${p.name}</div><div class="item-desc">${p.links.length} link${p.links.length>1?'s':''} available</div></div></div><div class="item-actions">${p.links.map((l,i)=>{
const lid=`${p.id}-${i}`;
const pd={id:lid,name:`${p.name} ${l.t}`,icon:p.icon,url:l.u,type:'proxy'};
const inst=INSTALLED.find(a=>a.id===lid);
return inst?`<button class="grid-btn success" onclick='launchProxy(${JSON.stringify(pd)})'>üåê Open Link</button><button class="grid-btn danger" onclick='uninstallApp("${lid}")'>üóëÔ∏è</button>`:`<button class="grid-btn primary" onclick='installProxy(${JSON.stringify(pd)})'>${l.t}</button>`;
}).join('')}</div></div>`).join('')}</div></div></div>
<div class="hub-tab" id="tab-tools"><div class="content-grid"><div style="margin-bottom:35px"><div class="grid-title">Tools & Apps</div><div class="grid-subtitle">${TOOLS.length} productivity tools available</div></div><div class="item-grid">${TOOLS.map(t=>{
const inst=INSTALLED.find(a=>a.id===t.id);
const isProtected=inst&&inst.protected;
return `<div class="item-card"><div class="item-header"><div class="item-icon">${t.icon}</div><div style="flex:1"><div class="item-name">${t.name}${isProtected?' üîí':''}</div><div class="item-desc">${t.cat}</div></div></div><div class="item-actions">${inst?`<button class="grid-btn success" onclick='openTool("${t.id}")'>‚ñ∂ Open App</button>${isProtected?'<button class="grid-btn" disabled style="opacity:0.5;cursor:not-allowed">üîí Protected</button>':`<button class="grid-btn danger" onclick='uninstallApp("${t.id}")'>üóëÔ∏è Remove</button>`}`:`<button class="grid-btn primary" onclick='installTool(${JSON.stringify(t)})'>üì• Install Tool</button>`}</div></div>`;
}).join('')}</div></div></div>
<div class="hub-tab" id="tab-installed"><div class="content-grid" id="installed-content">${renderInstalled()}</div></div>
</div>
</div>`;
bindHover();
});
}

function renderInstalled(){
return `<div style="margin-bottom:35px;display:flex;justify-content:space-between;align-items:center"><div><div class="grid-title">Installed Apps</div><div class="grid-subtitle">${INSTALLED.length} app${INSTALLED.length===1?'':'s'} installed on your system</div></div>${INSTALLED.filter(a=>!a.protected).length>0?'<button class="grid-btn danger" onclick="uninstallAll()">üóëÔ∏è Uninstall All</button>':''}</div><div class="item-grid">${INSTALLED.length===0?'<div style="grid-column:1/-1;padding:100px;text-align:center;color:var(--txt2)"><div style="font-size:90px;margin-bottom:28px;filter:drop-shadow(0 0 20px rgba(0,0,0,.5))">üì¶</div><div style="font-size:22px;font-weight:700;margin-bottom:14px">No Apps Installed Yet</div><div style="font-size:16px;line-height:1.6">Install games, proxies, and tools from the library to get started!</div></div>':INSTALLED.map(a=>{
const isProtected=a.protected;
return `<div class="item-card"><div class="item-header"><div class="item-icon">${a.icon}</div><div style="flex:1"><div class="item-name">${a.name}${isProtected?' üîí':''}</div><div class="item-desc">${a.type==='game'?'Game':a.type==='proxy'?'Proxy Service':'Tool'}</div></div></div><div class="item-actions">${a.type==='game'?`<button class="grid-btn primary" onclick='launchGame(${JSON.stringify(a)})'>üéÆ Play Game</button>`:a.type==='proxy'?`<button class="grid-btn primary" onclick='launchProxy(${JSON.stringify(a)})'>üåê Open Proxy</button>`:`<button class="grid-btn primary" onclick='openTool("${a.id}")'>‚ñ∂ Open App</button>`}${isProtected?'<button class="grid-btn" disabled style="opacity:0.5">üîí Protected</button>':`<button class="grid-btn danger" onclick='uninstallApp("${a.id}")'>üóëÔ∏è Remove</button>`}</div></div>`;
}).join('')}</div>`;
}

function openStyles(){
createWin('Styles','üé®','styles',content=>{
content.innerHTML=`
<div class="content-grid">
<div style="margin-bottom:45px"><div class="grid-title">Appearance Settings</div><div class="grid-subtitle">Customize Peak Hub to match your personal style</div></div>
<div style="margin-bottom:45px"><h3 style="font-size:20px;font-weight:700;margin-bottom:24px;color:var(--acc);text-shadow:0 0 15px var(--glow)">üé® Color Themes</h3><div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:24px">${['midnight','neon','aurora','sunset','cyber'].map(t=>{
let bg='';
if(t==='midnight')bg='linear-gradient(135deg,#0a0e27,#1e2749)';
else if(t==='neon')bg='linear-gradient(135deg,#000814,#001845,#ff00ff)';
else if(t==='aurora')bg='linear-gradient(135deg,#0a1a2d,#1f3a6d,#00ffaa)';
else if(t==='sunset')bg='linear-gradient(135deg,#1a0e1a,#3d2340,#ff6b35)';
else if(t==='cyber')bg='linear-gradient(135deg,#0d0d1a,#27274d,#00ffff)';
return `<div class="item-card ${settings.theme===t?'active':''}" onclick='changeTheme("${t}")' style="aspect-ratio:16/9;padding:0;position:relative;overflow:hidden;cursor:pointer;border-width:3px"><div style="width:100%;height:100%;background:${bg}"></div><div style="position:absolute;bottom:0;left:0;right:0;background:rgba(0,0,0,.95);padding:16px;font-size:14px;font-weight:700;text-align:center;backdrop-filter:blur(15px)">${t.charAt(0).toUpperCase()+t.slice(1)}${settings.theme===t?' ‚úì':''}</div></div>`;
}).join('')}</div></div>
<div style="margin-bottom:45px"><h3 style="font-size:20px;font-weight:700;margin-bottom:24px;color:var(--acc);text-shadow:0 0 15px var(--glow)">üñºÔ∏è Desktop Backgrounds</h3><div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:24px">${['gradient','stars','waves','aurora','sunset','matrix','neon'].map(b=>{
let bg='';
if(b==='gradient')bg='linear-gradient(135deg,#0a0e27,#1e2749)';
else if(b==='stars')bg='#000 radial-gradient(white,rgba(255,255,255,.3) 2px,transparent 3px)';
else if(b==='waves')bg='radial-gradient(circle,rgba(0,212,255,.2),transparent),#0a0e27';
else if(b==='aurora')bg='linear-gradient(135deg,#0a1a2d,#1f3a6d,#00ffaa)';
else if(b==='sunset')bg='linear-gradient(135deg,#1a0e1a,#3d2340,#ff6b35)';
else if(b==='matrix')bg='#001100';
else if(b==='neon')bg='#000';
return `<div class="item-card ${settings.bg===b?'active':''}" onclick='changeBg("${b}")' style="aspect-ratio:16/9;padding:0;position:relative;overflow:hidden;cursor:pointer;border-width:3px"><div style="width:100%;height:100%;background:${bg}"></div><div style="position:absolute;bottom:0;left:0;right:0;background:rgba(0,0,0,.95);padding:16px;font-size:14px;font-weight:700;text-align:center;backdrop-filter:blur(15px)">${b.charAt(0).toUpperCase()+b.slice(1)}${settings.bg===b?' ‚úì':''}</div></div>`;
}).join('')}</div></div>
<div><h3 style="font-size:20px;font-weight:700;margin-bottom:24px;color:var(--acc);text-shadow:0 0 15px var(--glow)">üñ±Ô∏è Cursor Color</h3><div class="color-picker">${['#00d4ff','#ff00ff','#00ffaa','#ff6b35','#00ffff','#ff0000','#00ff00','#ffff00','#ff69b4','#9370ff','#ffd700','#fff'].map(c=>`<div class="color-swatch ${settings.cursor===c?'active':''}" style="background:${c}" onclick='changeCursor("${c}")'></div>`).join('')}</div></div>
</div>`;
bindHover();
});
}

window.switchTab=tab=>{$$('.nav-btn').forEach(b=>b.classList.remove('active'));$$('.hub-tab').forEach(t=>t.classList.remove('active'));event.target.classList.add('active');$(`#tab-${tab}`).classList.add('active')};

window.installGame=g=>{if(INSTALLED.find(a=>a.id===g.id)){toast('Already Installed! ‚ö†Ô∏è',`${g.name} is already installed`,'error');return}INSTALLED.push({...g,type:'game'});saveData('installed',INSTALLED);toast('Installed! üéâ',`${g.name} is ready to play`);renderDesktop();refreshHub()};

window.installProxy=p=>{if(INSTALLED.find(a=>a.id===p.id)){toast('Already Installed! ‚ö†Ô∏è',`${p.name} is already installed`,'error');return}INSTALLED.push(p);saveData('installed',INSTALLED);toast('Installed! üéâ',`${p.name} is ready to use`);renderDesktop();refreshHub()};

window.installTool=t=>{if(INSTALLED.find(a=>a.id===t.id)){toast('Already Installed! ‚ö†Ô∏è',`${t.name} is already installed`,'error');return}INSTALLED.push({...t,type:'tool'});saveData('installed',INSTALLED);toast('Installed! üéâ',`${t.name} is ready to use`);renderDesktop();refreshHub()};

window.uninstallApp=id=>{const app=INSTALLED.find(a=>a.id===id);if(!app)return;if(app.protected){toast('Cannot Delete! üîí','This app is protected and cannot be removed','error');return}INSTALLED=INSTALLED.filter(a=>a.id!==id);saveData('installed',INSTALLED);toast('Uninstalled! üóëÔ∏è',`${app.name} has been removed`);renderDesktop();refreshHub()};

window.uninstallAll=()=>{const unprotected=INSTALLED.filter(a=>!a.protected);if(unprotected.length===0){toast('Nothing to Remove! ‚ö†Ô∏è','All apps are protected','error');return}if(confirm(`Uninstall ${unprotected.length} app${unprotected.length===1?'':'s'}?`)){INSTALLED=INSTALLED.filter(a=>a.protected);saveData('installed',INSTALLED);toast('All Uninstalled! üóëÔ∏è','Unprotected apps removed');renderDesktop();refreshHub()}};

function refreshHub(){const hw=windows.find(w=>w.type==='hub');if(hw){const tab=$$('.hub-tab.active')[0];if(tab&&tab.id==='tab-installed'){const content=$('#installed-content');if(content)content.innerHTML=renderInstalled()}}}

window.launchGame=g=>createWin(g.name,g.icon,`game-${g.id}`,c=>c.innerHTML=`<iframe src="${g.url}" style="width:100%;height:100%;border:none;background:#000"></iframe>`);

window.launchProxy=p=>createWin(p.name,p.icon,`proxy-${p.id}`,c=>c.innerHTML=`<iframe src="${p.url}" style="width:100%;height:100%;border:none;background:#000"></iframe>`);

// SCRAMJET PROXY BROWSER + ALL TOOLS
window.openTool=id=>{
if(id==='browser')createWin('Browser','üåç','browser',c=>{
c.innerHTML=`<div style="display:flex;flex-direction:column;height:100%"><div style="padding:18px;background:var(--bg3);border-bottom:2px solid var(--border-acc);display:flex;gap:14px;align-items:center"><button class="grid-btn" onclick="document.getElementById('proxy-frame').contentWindow.history.back()" title="Back">‚Üê</button><button class="grid-btn" onclick="document.getElementById('proxy-frame').contentWindow.history.forward()" title="Forward">‚Üí</button><button class="grid-btn" onclick="loadProxyUrl(true)" title="Reload">‚Üª</button><input type="text" id="proxy-url" placeholder="Enter URL or search..." value="" style="flex:1;background:var(--bg);border:2px solid var(--border);border-radius:12px;padding:14px 18px;color:var(--txt);font-size:15px;font-weight:600"><button class="grid-btn primary" onclick="loadProxyUrl()">Go</button></div><iframe id="proxy-frame" style="flex:1;border:none;background:#fff"></iframe></div>`;
const urlInput=$('#proxy-url');
urlInput.addEventListener('keypress',e=>{if(e.key==='Enter')loadProxyUrl()});
setTimeout(()=>{urlInput.value='https://google.com';loadProxyUrl()},200);
bindHover();
});
else if(id==='notes')createWin('Notes','üìù','notes',c=>{
const notes=loadData('notes',[]);
c.innerHTML=`<div style="display:flex;height:100%"><div style="width:300px;background:var(--bg3);border-right:2px solid var(--border-acc);padding:28px;display:flex;flex-direction:column"><button class="grid-btn primary" style="width:100%;margin-bottom:28px;font-size:15px" onclick="createNote()">üìù New Note</button><div id="notes-list" style="display:flex;flex-direction:column;gap:14px;flex:1;overflow-y:auto">${notes.map((n,i)=>`<div class="item-card" style="padding:18px;cursor:pointer" onclick="loadNote(${i})"><div style="font-size:15px;font-weight:700;margin-bottom:8px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${n.title||'Untitled Note'}</div><div style="font-size:12px;color:var(--txt2);overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${n.content.substring(0,60)}...</div></div>`).join('')}</div></div><div style="flex:1;padding:32px;display:flex;flex-direction:column"><input id="note-title" placeholder="Note title..." style="background:var(--bg3);border:2px solid var(--border);border-radius:14px;padding:20px;font-size:22px;font-weight:700;color:var(--txt);margin-bottom:22px"><textarea id="note-content" placeholder="Start typing your note..." style="flex:1;background:var(--bg3);border:2px solid var(--border);border-radius:14px;padding:20px;color:var(--txt);resize:none;font-size:16px;line-height:1.8"></textarea><button class="grid-btn primary" style="margin-top:22px;font-size:16px" onclick="saveNote()">üíæ Save Note</button></div></div>`;
bindHover();
});
else if(id==='calculator')createWin('Calculator','üî¢','calculator',c=>{
c.innerHTML=`<div style="display:flex;flex-direction:column;height:100%;background:var(--bg);padding:32px"><div id="calc-display" style="background:var(--bg3);border-radius:18px;padding:36px;margin-bottom:28px;text-align:right;font-size:52px;font-family:'Fira Code',monospace;color:var(--txt);min-height:110px;display:flex;align-items:center;justify-content:flex-end;border:2px solid var(--border-acc);box-shadow:0 10px 30px rgba(0,0,0,.5)">0</div><div style="display:grid;grid-template-columns:repeat(4,1fr);gap:16px;flex:1">${['C','‚Üê','%','√∑','7','8','9','√ó','4','5','6','-','1','2','3','+','0','.','='].map(btn=>`<button class="grid-btn${btn==='='?' primary':''}" style="font-size:26px;min-height:75px;font-weight:800${btn==='='?';grid-column:span 2':''}" onclick="calcBtn('${btn}')">${btn}</button>`).join('')}</div></div>`;
bindHover();
});
else if(id==='music')createWin('Music Player','üéµ','music',c=>{
c.innerHTML=`<div style="height:100%;display:flex;flex-direction:column;background:var(--bg)"><div style="flex:1;padding:32px;display:flex;flex-direction:column;align-items:center;justify-content:center"><iframe src="https://open.spotify.com/embed/playlist/37i9dQZF1DXcBWIGoYBM5M?theme=0" width="100%" height="520" frameborder="0" allow="encrypted-media" style="border-radius:18px;box-shadow:0 12px 40px rgba(0,0,0,.7)"></iframe></div><div style="padding:32px;border-top:2px solid var(--border-acc);text-align:center;background:var(--bg3)"><div style="color:var(--txt);font-size:18px;font-weight:700;margin-bottom:10px">üéµ Spotify Web Player</div><div style="color:var(--txt2);font-size:14px;font-weight:600">Use the controls above to browse and play music</div></div></div>`;
});
else if(id==='files')createWin('File Manager','üìÅ','files',c=>{
c.innerHTML=`<div class="content-grid"><div style="margin-bottom:35px"><div class="grid-title">File Manager</div><div class="grid-subtitle">Organize and manage your files</div></div><div style="padding:120px;text-align:center;color:var(--txt2)"><div style="font-size:90px;margin-bottom:28px;filter:drop-shadow(0 0 20px rgba(0,0,0,.6))">üìÅ</div><div style="font-size:22px;font-weight:700;margin-bottom:14px">No Files Yet</div><div style="font-size:16px;line-height:1.6">File management features coming soon!</div></div></div>`;
});
else if(id==='sysinfo')createWin('System Info','üíª','sysinfo',c=>{
const info={
'Operating System':'Peak Hub Ultimate Edition',
'Browser':navigator.userAgent.split(')')[0]+')',
'Language':navigator.language,
'Platform':navigator.platform,
'Online Status':navigator.onLine?'‚úì Connected':'‚úó Offline',
'Cookies':navigator.cookieEnabled?'‚úì Enabled':'‚úó Disabled',
'Screen Resolution':`${screen.width} √ó ${screen.height}`,
'Color Depth':`${screen.colorDepth}-bit`,
'Current Theme':settings.theme.charAt(0).toUpperCase()+settings.theme.slice(1),
'Background Style':settings.bg.charAt(0).toUpperCase()+settings.bg.slice(1),
'Apps Installed':INSTALLED.length,
'Windows Open':windows.length,
'Local Storage':Object.keys(localStorage).length+' items'
};
c.innerHTML=`<div class="content-grid"><div style="margin-bottom:35px"><div class="grid-title">System Information</div><div class="grid-subtitle">Detailed system statistics and configuration</div></div><div style="background:var(--bg3);padding:32px;border-radius:20px;font-family:'Fira Code',monospace;font-size:15px;border:2px solid var(--border-acc);box-shadow:0 10px 35px rgba(0,0,0,.5)">${Object.entries(info).map(([k,v])=>`<div style="margin-bottom:18px;display:flex;justify-content:space-between;padding-bottom:18px;border-bottom:2px solid var(--border)"><span style="color:var(--acc);font-weight:700;text-shadow:0 0 10px var(--glow)">${k}</span><span style="color:var(--txt);font-weight:600">${v}</span></div>`).join('')}</div></div>`;
});
else if(id==='settings')createWin('Settings','‚öôÔ∏è','settings',c=>{
c.innerHTML=`<div class="content-grid"><div style="margin-bottom:35px"><div class="grid-title">Settings</div><div class="grid-subtitle">Configure Peak Hub system settings</div></div><div style="display:flex;flex-direction:column;gap:28px"><div style="background:var(--bg3);padding:32px;border-radius:20px;border:2px solid var(--border-acc);box-shadow:0 8px 28px rgba(0,0,0,.5)"><h3 style="font-size:20px;margin-bottom:24px;color:var(--acc);font-weight:700;text-shadow:0 0 15px var(--glow)">üë§ User Account</h3><p style="font-size:16px;margin-bottom:10px">Username: <strong style="color:var(--acc)">${currentUser.username}</strong></p><p style="font-size:14px;color:var(--txt2);font-weight:600">Status: <span style="color:#10b981">‚óè Active & Online</span></p></div><div style="background:var(--bg3);padding:32px;border-radius:20px;border:2px solid var(--border-acc);box-shadow:0 8px 28px rgba(0,0,0,.5)"><h3 style="font-size:20px;margin-bottom:24px;color:var(--acc);font-weight:700;text-shadow:0 0 15px var(--glow)">üíæ Storage & System</h3><p style="font-size:16px;margin-bottom:14px">Apps Installed: <strong style="color:var(--acc)">${INSTALLED.length}</strong></p><p style="font-size:16px;margin-bottom:14px">Windows Open: <strong style="color:var(--acc)">${windows.length}</strong></p><p style="font-size:16px;margin-bottom:14px">Active Theme: <strong style="color:var(--acc)">${settings.theme}</strong></p><p style="font-size:16px">Background: <strong style="color:var(--acc)">${settings.bg}</strong></p></div><div style="background:var(--bg3);padding:32px;border-radius:20px;border:2px solid var(--border-acc);box-shadow:0 8px 28px rgba(0,0,0,.5)"><h3 style="font-size:20px;margin-bottom:24px;color:var(--acc);font-weight:700;text-shadow:0 0 15px var(--glow)">‚ö° System Actions</h3><button class="grid-btn danger" style="width:100%;margin-bottom:14px;font-size:16px" onclick="if(confirm('‚ö†Ô∏è Reset all data and settings? This CANNOT be undone!')){localStorage.clear();location.reload()}">üîÑ Reset All Data</button><button class="grid-btn" style="width:100%;font-size:16px" onclick="window.logout()">üîì Logout from Peak Hub</button></div></div></div>`;
bindHover();
});
else if(id==='terminal')createWin('Terminal','‚å®Ô∏è','terminal',c=>{
c.innerHTML=`<div style="height:100%;display:flex;flex-direction:column;background:#000;padding:20px;font-family:'Fira Code',monospace"><div id="terminal-output" style="flex:1;overflow-y:auto;color:#0f0;font-size:14px;line-height:1.6"></div><div style="display:flex;gap:10px;margin-top:10px"><span style="color:#0f0">$</span><input type="text" id="terminal-input" placeholder="Type 'help' for commands..." style="flex:1;background:transparent;border:none;color:#0f0;font-family:'Fira Code',monospace;font-size:14px;outline:none"></div></div>`;
const output=$('#terminal-output');
const input=$('#terminal-input');
const commands={'help':'Available: help, clear, date, sysinfo, echo','clear':'','date':new Date().toString(),'sysinfo':`Peak Hub v1.0\\nApps: ${INSTALLED.length}\\nTheme: ${settings.theme}`};
output.innerHTML='<div>Peak Hub Terminal v1.0</div><div>Type "help" for available commands</div><div>---</div>';
input.addEventListener('keypress',e=>{
if(e.key==='Enter'){
const cmd=input.value.trim();
output.innerHTML+=`<div style="margin-top:10px">$ ${cmd}</div>`;
if(cmd==='clear')output.innerHTML='';
else if(cmd.startsWith('echo '))output.innerHTML+=`<div>${cmd.substring(5)}</div>`;
else output.innerHTML+=`<div>${commands[cmd]||'Command not found: '+cmd}</div>`;
input.value='';
output.scrollTop=output.scrollHeight;
}
});
});
else if(id==='paint')createWin('Paint','üé®','paint',c=>{
c.innerHTML=`<div style="height:100%;display:flex;flex-direction:column"><div style="padding:14px;background:var(--bg3);border-bottom:2px solid var(--border-acc);display:flex;gap:10px"><input type="color" id="paint-color" value="#00d4ff" style="width:50px;height:40px;border:none;border-radius:8px;cursor:pointer"><button class="grid-btn" onclick="document.getElementById('paint-canvas').getContext('2d').clearRect(0,0,9999,9999)">Clear</button><input type="range" id="paint-size" min="1" max="50" value="5" style="width:150px"></div><canvas id="paint-canvas" style="flex:1;background:#fff;cursor:crosshair"></canvas></div>`;
const canvas=$('#paint-canvas');
const ctx=canvas.getContext('2d');
canvas.width=canvas.offsetWidth;
canvas.height=canvas.offsetHeight;
let painting=false;
canvas.addEventListener('mousedown',()=>painting=true);
canvas.addEventListener('mouseup',()=>painting=false);
canvas.addEventListener('mousemove',e=>{
if(!painting)return;
const rect=canvas.getBoundingClientRect();
const x=e.clientX-rect.left;
const y=e.clientY-rect.top;
ctx.fillStyle=$('#paint-color').value;
ctx.beginPath();
ctx.arc(x,y,$('#paint-size').value,0,Math.PI*2);
ctx.fill();
});
});
};

// SCRAMJET PROXY LOADER (Ultraviolet)
window.loadProxyUrl=(reload=false)=>{
const frame=$('#proxy-frame');
const urlInput=$('#proxy-url');
if(!frame||!urlInput)return;
if(reload){frame.src=frame.src;return}
let url=urlInput.value.trim();
if(!url)return;
if(!url.includes('://')){
if(url.includes('.')){
url='https://'+url;
}else{
url='https://www.google.com/search?q='+encodeURIComponent(url);
}
}
const proxyUrl='https://uv.lucavm.workers.dev/'+encodeURIComponent(url);
frame.src=proxyUrl;
};

let calcVal='0',calcOp=null,calcPrev=null;
window.calcBtn=b=>{
const disp=$('#calc-display');
if(!disp)return;
if(b==='C'){calcVal='0';calcOp=null;calcPrev=null}
else if(b==='‚Üê'){calcVal=calcVal.slice(0,-1)||'0'}
else if(['+','-','√ó','√∑','%'].includes(b)){calcOp=b;calcPrev=parseFloat(calcVal);calcVal='0'}
else if(b==='='){
if(calcOp&&calcPrev!==null){
const cur=parseFloat(calcVal);
let res=0;
if(calcOp==='+')res=calcPrev+cur;
else if(calcOp==='-')res=calcPrev-cur;
else if(calcOp==='√ó')res=calcPrev*cur;
else if(calcOp==='√∑')res=calcPrev/cur;
else if(calcOp==='%')res=calcPrev%cur;
calcVal=res.toString();
calcOp=null;
calcPrev=null;
}
}else{
if(calcVal==='0'&&b!=='.')calcVal=b;
else calcVal+=b;
}
disp.textContent=calcVal;
};

let curNoteIdx=null;
window.createNote=()=>{curNoteIdx=null;$('#note-title').value='';$('#note-content').value='';$('#note-title').focus()};
window.loadNote=i=>{const notes=loadData('notes',[]);curNoteIdx=i;$('#note-title').value=notes[i].title;$('#note-content').value=notes[i].content};
window.saveNote=()=>{
const notes=loadData('notes',[]);
const title=$('#note-title').value.trim()||'Untitled Note';
const content=$('#note-content').value.trim();
if(!content){toast('Cannot Save! ‚ö†Ô∏è','Note content is empty','error');return}
const note={title,content,date:new Date().toISOString()};
if(curNoteIdx!==null)notes[curNoteIdx]=note;
else notes.push(note);
saveData('notes',notes);
toast('Note Saved! üìù',`"${title}" has been saved successfully`);
const notesList=$('#notes-list');
if(notesList){notesList.innerHTML=notes.map((n,i)=>`<div class="item-card" style="padding:18px;cursor:pointer" onclick="loadNote(${i})"><div style="font-size:15px;font-weight:700;margin-bottom:8px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${n.title||'Untitled Note'}</div><div style="font-size:12px;color:var(--txt2);overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${n.content.substring(0,60)}...</div></div>`).join('');bindHover()}
};

window.changeTheme=t=>{settings.theme=t;applySettings();toast('Theme Changed! üé®',`Now using ${t.charAt(0).toUpperCase()+t.slice(1)} theme`)};
window.changeBg=b=>{settings.bg=b;applySettings();toast('Background Changed! üñºÔ∏è',`Now using ${b.charAt(0).toUpperCase()+b.slice(1)} background`)};
window.changeCursor=c=>{settings.cursor=c;applySettings();toast('Cursor Updated! üñ±Ô∏è','Cursor color has been changed')};

window.logout=()=>{if(confirm('‚ö†Ô∏è Logout from Peak Hub?')){saveData('currentUser',null);location.reload()}};

document.addEventListener('DOMContentLoaded',()=>{
const ls=$('#loading-screen'),lp=$('#loading-progress'),lst=$('#loading-stats');
const steps=[
{t:"Initializing core systems...",p:15},
{t:"Loading game library...",p:30},
{t:"Configuring proxy network...",p:45},
{t:"Setting up tools...",p:60},
{t:"Preparing desktop environment...",p:75},
{t:"Finalizing components...",p:90},
{t:"System ready!",p:100}
];
let s=0;
function upd(){
if(s>=steps.length){
setTimeout(()=>ls.classList.add('hidden'),700);
return;
}
lp.style.width=steps[s].p+'%';
lst.textContent=steps[s].t;
s++;
setTimeout(upd,550);
}
setTimeout(upd,1200);
setTimeout(()=>{
const u=loadData('currentUser');
if(u&&u.username){
currentUser=u;
$('#login-screen').style.display='none';
document.body.classList.add('logged-in');
initDesktop();
}else{
initAuth();
}
},4500);
});
</script>
</body>
</html>
